# ุฏููู ุงูุงูุชูุงู ูู Farkha API v1.0 ุฅูู v2.0

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุนุงุฏุฉ ููููุฉ ุงููุดุฑูุน ุจุงููุงูู ูุชุญุณูู ุงูุฃูุงู ูุงูุฃุฏุงุก ูุงููุงุจููุฉ ููุตูุงูุฉ. ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงูุงูุชูุงู ูู ุงููุธุงู ุงููุฏูู ุฅูู ุงููุธุงู ุงูุฌุฏูุฏ.

## ๐ ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ

### 1. ูููู ุงููุดุฑูุน
**ูุฏูู:**
```
โโโ connect.php
โโโ function.php
โโโ config.php
โโโ create/
โ   โโโ add.php
โ   โโโ suggestion.php
โโโ read/
    โโโ main.php
    โโโ last_prices.php
    โโโ ...
```

**ุฌุฏูุฏ:**
```
โโโ app/
โ   โโโ config/
โ   โโโ controllers/
โ   โโโ core/
โ   โโโ middleware/
โ   โโโ models/
โ   โโโ utils/
โโโ public/
โ   โโโ index.php
โ   โโโ routes.php
โโโ logs/
```

### 2. ููุงุท ุงูููุงูุฉ (Endpoints)

| ุงููุธุงู ุงููุฏูู | ุงููุธุงู ุงูุฌุฏูุฏ | ุงูููุงุญุธุงุช |
|--------------|--------------|----------|
| `POST /create/add.php` | `POST /prices/add` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `POST /create/suggestion.php` | `POST /suggestions/add` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `GET /read/main.php` | `GET /main` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `GET /read/last_prices.php` | `POST /prices/by-type` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `GET /read/web_last_prices.php` | `GET /prices/web` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `GET /read/farkh_abid.php` | `GET /prices/latest?type=1` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |
| `GET /read/feasibility_study.php` | `GET /prices/feasibility-study` | โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ |

## ๐๏ธ ุฎุทูุงุช ุงูุงูุชูุงู

### ุงูุฎุทูุฉ 1: ุงููุณุฎ ุงูุงุญุชูุงุทู
```bash
# ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงููุธุงู ุงููุฏูู
cp -r /path/to/old/project /path/to/backup/
```

### ุงูุฎุทูุฉ 2: ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู
```apache
# ุชุญุฏูุซ DocumentRoot ูู Apache
DocumentRoot /path/to/project/public

# ุฃู ุฅุถุงูุฉ Virtual Host
<VirtualHost *:80>
    DocumentRoot /path/to/project/public
    ServerName farkha-api.local
</VirtualHost>
```

### ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
```bash
# ูุณุฎ ููู ุงูุฅุนุฏุงุฏุงุช
cp env.example .env

# ุชุญุฑูุฑ ุงูุฅุนุฏุงุฏุงุช
nano .env
```

**ููู .env:**
```env
# ูู config.php ุงููุฏูู
DB_HOST=localhost
DB_NAME=farkha
DB_USER=root
DB_PASS=

# ูู function.php ุงููุฏูู
BASIC_AUTH_USER=NiMs_farkha
BASIC_AUTH_PASS=Abdallh29512A

# ุฅุนุฏุงุฏุงุช ุฌุฏูุฏุฉ
JWT_SECRET=your-new-secure-secret-key
APP_DEBUG=false
```

### ุงูุฎุทูุฉ 4: ุชุญุฏูุซ ุฃุฐููุงุช ุงููููุงุช
```bash
chmod 755 logs/
chmod 644 .env
chmod 755 public/
```

### ุงูุฎุทูุฉ 5: ุงุฎุชุจุงุฑ ุงููุธุงู
```bash
# ูุญุต ุงูุตุญุฉ
curl http://localhost/health

# ุงุฎุชุจุงุฑ API ูุฏูู (ูุฌุจ ุฃู ูุนูุฏ ุชูุฌูู)
curl -I http://localhost/read/main.php

# ุงุฎุชุจุงุฑ API ุฌุฏูุฏ
curl http://localhost/main
```

## ๐ง ุชุญุฏูุซ ุงูุชุทุจููุงุช ุงูุนูููุฉ

### ููุชุทุจููุงุช ุงูุชู ุชุณุชุฎุฏู ุงููุธุงู ุงููุฏูู:

#### 1. ูุง ุญุงุฌุฉ ูุชุบููุฑ ููุฑู
- ุงููุธุงู ุงูุฌุฏูุฏ ูุฏุนู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุงูุชููุงุฆูุฉ
- ุงูุงุณุชุฌุงุจุงุช ุชุญุงูุธ ุนูู ููุณ ุงูุชูุณูู

#### 2. ุงูุชุญุฏูุซ ุงููููุตู ุจู (ุงุฎุชูุงุฑู):
```dart
// ูุฏูู
final response = await http.post(
  Uri.parse('$baseUrl/create/add.php'),
  body: {'price': '25.50', 'type_id': '1'}
);

// ุฌุฏูุฏ (ูููุตู ุจู)
final response = await http.post(
  Uri.parse('$baseUrl/prices/add'),
  body: {'price': '25.50', 'type_id': '1'}
);
```

## ๐ ููุงุฑูุฉ ุงูููุฒุงุช

| ุงูููุฒุฉ | ุงููุธุงู ุงููุฏูู | ุงููุธุงู ุงูุฌุฏูุฏ |
|-------|--------------|--------------|
| **ุงูุฃูุงู** | โ๏ธ Basic Auth ููุท | โ JWT + Basic Auth |
| **ุงูุชุญูู ูู ุงูุจูุงูุงุช** | โ๏ธ ูุญุฏูุฏ | โ ุดุงูู ูููุตู |
| **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** | โ ุฃุณุงุณูุฉ | โ ูุชูุฏูุฉ ูุน logging |
| **ุงูุฃุฏุงุก** | โ๏ธ ูุชูุณุท | โ ูุญุณูู |
| **ุงูุชูุซูู** | โ ุบูุฑ ููุฌูุฏ | โ ูุฏูุฌ ูู API |
| **CORS** | โ๏ธ ุฃุณุงุณู | โ ูุงุจู ููุชูููู |
| **ุงูุชุญูู ุจุงูุฅุตุฏุงุฑุงุช** | โ ุบูุฑ ููุฌูุฏ | โ ูุฏูุฌ |
| **ุงูุจูุฆุงุช ุงููุชุนุฏุฏุฉ** | โ ุบูุฑ ูุฏุนูู | โ ูุฏุนูู |

## ๐ ุชุญุณููุงุช ุงูุฃูุงู

### 1. ุญูุงูุฉ ูููุงุช ุงููุฑูุฑ
```php
// ูุฏูู: ูู ุงูููุฏ ูุจุงุดุฑุฉ
define('PHP_PASS', "Abdallh29512A");

// ุฌุฏูุฏ: ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
BASIC_AUTH_PASS=your_secure_password
```

### 2. ุงูุชุญูู ูู ุงูุจูุงูุงุช
```php
// ูุฏูู: ุชุญูู ุจุณูุท
$price = filterRequset('price');

// ุฌุฏูุฏ: ุชุญูู ุดุงูู
$validator->required('price')
          ->numeric('price')
          ->positive('price');
```

### 3. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
```php
// ูุฏูู: ุนุฑุถ ุงูุฃุฎุทุงุก ูุจุงุดุฑุฉ
echo $e->getMessage();

// ุฌุฏูุฏ: logging ุขูู
Logger::error($e->getMessage());
ResponseHandler::serverError('Internal server error');
```

## ๐ ููุงุฆุฏ ุงููุธุงู ุงูุฌุฏูุฏ

### 1. **ุฃูุงู ูุญุณูู**
- JWT tokens ูููุตุงุฏูุฉ
- ุชุดููุฑ ูุชูุฏู ููููุงุช ุงููุฑูุฑ
- ุญูุงูุฉ ูู SQL Injection ู XSS
- CORS ูุงุจู ููุชูููู

### 2. **ุฃุฏุงุก ุฃูุถู**
- Connection pooling
- Prepared statements caching
- ุงุณุชุนูุงูุงุช ูุญุณููุฉ
- Response caching

### 3. **ูุงุจููุฉ ุงูุตูุงูุฉ**
- ููุฏ ููุธู ูููููู
- ูุตู ุงูุงูุชูุงูุงุช (Separation of concerns)
- Repository pattern
- Dependency injection

### 4. **ูุฑุงูุจุฉ ูุญุณููุฉ**
- Logging ุดุงูู
- Error tracking
- Performance monitoring
- Health checks

## ๐จ ุฃููุฑ ูููุฉ ููุงูุชุจุงู

### 1. **ูุงุนุฏุฉ ุงูุจูุงูุงุช**
- ูุง ุญุงุฌุฉ ูุชุบููุฑ ูู ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงููุธุงู ุงูุฌุฏูุฏ ูุนูู ูุน ููุณ ุงูุฌุฏุงูู

### 2. **ุงููููุงุช ุงููุฏููุฉ**
- ูููู ุงูุงุญุชูุงุธ ุจูุง ููุณุฎุฉ ุงุญุชูุงุทูุฉ
- ูุง ุชุคุซุฑ ุนูู ุงููุธุงู ุงูุฌุฏูุฏ

### 3. **ุงูุชุทุจููุงุช ุงูุนูููุฉ**
- ุณุชุนูู ุจุฏูู ุชุบููุฑ (ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ)
- ูููุถู ุงูุชุญุฏูุซ ููููุงุท ุงูุฌุฏูุฏุฉ ุชุฏุฑูุฌูุงู

## ๐ ุงููุณุงุนุฏุฉ ูุงูุฏุนู

### ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู:

1. **ุชุญูู ูู logs:**
   ```bash
   tail -f logs/app.log
   ```

2. **ุงุฎุชุจุฑ health check:**
   ```bash
   curl http://localhost/health
   ```

3. **ุชุญูู ูู ุฅุนุฏุงุฏุงุช .env**

4. **ุชุญูู ูู ุฃุฐููุงุช ุงููููุงุช**

### ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ:

| ุงูุฎุทุฃ | ุงูุณุจุจ | ุงูุญู |
|-------|-------|-----|
| "Database connection failed" | ุฎุทุฃ ูู ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช | ุชุญูู ูู .env |
| "Missing authentication" | Basic Auth ุบูุฑ ููุนุฏู | ุชุญูู ูู username/password |
| "Permission denied" | ุฃุฐููุงุช ุงููููุงุช | `chmod 755 logs/` |

---

**ูุตูุญุฉ:** ุงุจุฏุฃ ุจุชุดุบูู ุงููุธุงููู ุฌูุจุงู ุฅูู ุฌูุจ ููุชุฃูุฏ ูู ุงูุงุณุชูุฑุงุฑ ูุจู ุฅููุงู ุงููุธุงู ุงููุฏูู ููุงุฆูุงู.
